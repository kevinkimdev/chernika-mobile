<!--
  This template loads for the 'tab.friend-detail' state (app.js)
  'friend' is a $scope variable created in the FriendsCtrl controller (controllers.js)
  The FriendsCtrl pulls data from the Friends service (service.js)
  The Friends service returns an array of friend data
-->
<ion-view view-title="{{chat.name}}">
    <ion-content class="padding">
        <ion-refresher
                pulling-text="Более ранние сообщения..."
                on-refresh="doRefresh()">
        </ion-refresher>
        <div class="card"
             ng-repeat="msg in messages track by msg._id"
             ng-class="{ 'out-message': isMsgYours(msg), 'in-message': !isMsgYours(msg), 'sending': msg.isSending }">
            <div class="item item-divider msg-header">
                <span class="name" ng-bind="isMsgYours(msg) ? 'Вы' : chat.name"></span>
                <span class="time pull-right" ng-bind="msg.created | date : 'HH:mm'"></span>
            </div>
            <div class="item item-text-wrap msg-content" ng-bind="msg.text"></div>
        </div>

    </ion-content>
    <ion-footer-bar keyboard-attach class="bar-stable item-input-inset">
        <label class="item-input-wrapper">
            <input type="text" placeholder="Ваше сообщение" on-return="sendMessage()" ng-model="activeMessage" on-focus="inputUp()" on-blur="inputDown()" />
        </label>
        <button class="button button-clear ion-play" ng-click="sendMessage()" ng-disabled="!activeMessage"></button>
    </ion-footer-bar>
</ion-view>